import pandas as pd
import joblib
import boto3
from io import BytesIO

# AWS credentials and S3 bucket details
aws_access_key_id = 'YOUR_ACCESS_KEY'
aws_secret_access_key = 'YOUR_SECRET_KEY'
bucket_name = 'your-s3-bucket'
key = 'path/to/your/joblib/file.joblib'  # Path to your joblib file in S3

# Create a session using your AWS credentials
session = boto3.Session(
    aws_access_key_id=aws_access_key_id,
    aws_secret_access_key=aws_secret_access_key
)

# Create an S3 client
s3 = session.client('s3')

# Download the joblib file from S3
response = s3.get_object(Bucket=bucket_name, Key=key)

# Load the joblib file using joblib
joblib_file = response['Body'].read()
loaded_object = joblib.load(BytesIO(joblib_file))

# Assuming loaded_object contains a pandas DataFrame
# Handle the loaded object accordingly
if isinstance(loaded_object, pd.DataFrame):
    dataframe = loaded_object
    # Now you have your DataFrame, and you can work with it as needed
    print(dataframe.head())
else:
    print("Loaded object is not a pandas DataFrame.")
